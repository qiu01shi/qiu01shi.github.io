---
layout: post
title: 字节码文件详解
date: 2024-07-08 20:08 +0800
categories: [Java, JVM]
author: <author_id>  
---

## JVM 的组成

Java 虚拟机主要分为以下几个组成部分：



<img src="../media/2024-07-08-%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/image-20240708201451471.png" alt="image-20240708201451471" style="zoom:35%;" />



- 类加载子系统：核心组件类加载器，负责将字节码文件中的内容加载到内存中。
- 运行时数据区：JVM管理的内存，创建出来的对象、类的信息等等内容都会放在这块区域中。
- 执行引擎：包含了即时编译器、解释器、垃圾回收器，执行引擎使用解释器将字节码指令解释成机器码，使用即时编译器优化性能，使用垃圾回收器回收不再使用的对象。

- 本地接口：调用本地使用C/C++编译好的方法，本地方法在Java中声明时，都会带上 native 关键字，如下图所示。

<img src="../media/2024-07-08-%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/image-20240708201654978.png" alt="image-20240708201654978" style="zoom:45%;" />



## 字节码文件的组成

使用 jclasslib 工具查看字节码文件；Github地址： https://github.com/ingokegel/jclasslib

<img src="../media/2024-07-08-%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/image-20240708202140821.png" alt="image-20240708202140821" style="zoom:45%;" />

字节码文件总共可以分为以下几个部分：

- **基础信息**：魔数、字节码文件对应的Java版本号、访问标识(public final等等)、父类和接口信息；
- **常量池**： 保存了字符串常量、类或接口名、字段名，主要在字节码指令中使用；
- **字段：** 当前类或接口声明的字段信息；
- **方法：** 当前类或接口声明的方法信息，核心内容为方法的字节码指令；
- **属性：** 类的属性，比如源码的文件名、内部类的列表等；



### 基本信息

包含了 jclasslib 中能看到的两块内容：

<img src="../media/2024-07-08-%E5%AD%97%E8%8A%82%E7%A0%81%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/image-20240708202711822.png" alt="image-20240708202711822" style="zoom:65%;" />























