---
layout: post
title: 项目基本环境与介绍
date: 2024-06-25 21:44 +0800
categories: [TJU-news]
author: <author_id>
---

登陆功能的基本流程：

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625215226560.png" alt="image-20240625215226560" style="zoom:40%;" />





<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625215340402.png" alt="image-20240625215340402" style="zoom:40%;" />



## 项目技术栈

基础层：

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625215429943.png" alt="image-20240625215429943" style="zoom:40%;" />

服务层：

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625215529989.png" alt="image-20240625215529989" style="zoom:40%;" />



## Nacos



## 初始工程搭建

**项目依赖环境：**

- JDK1.8

- Intellij Idea

- maven-3.6.1
- Git



**工程主题结构：**

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625220234725.png" alt="image-20240625220234725" style="zoom:35%;" />



**全局异常处理：**

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625220555896.png" alt="image-20240625220555896" style="zoom:35%;" />



## APP 登录

- 用户点击开始使用

	登录后的用户权限较大，可以查看，也可以操作（点赞，关注，评论）



- 用户点击不登录，先看看

	游客只有查看的权限

	<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625221306461.png" alt="image-20240625221306461" style="zoom:40%;" />

### 表结构分析

关于 app 端用户相关的内容较多，单独设置一个库 `leadnews_user` 用于存储

|    **表名称**    |      **说明**      |
| :--------------: | :----------------: |
|     ap_user      |   APP 用户信息表   |
|   ap_user_fan    | APP 用户粉丝信息表 |
|  ap_user_follow  | APP 用户关注信息表 |
| ap_user_realname | APP 实名认证信息表 |

登录需要用到的是 `ap_user` 表，表结构如下：

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625224341998.png" alt="image-20240625224341998" style="zoom:40%;" />

⚠️ 注意事项：

`tinyint` 类型：占 1 个字节，不指定 unsigned (非负数)，值范围 (-128,127)，指定了 unsigned，值范围 (0,255)

`tinyint` 通常表示小范围的数值，或者表示 `true` 或 `false`，通常值为 0 表示 `false`,值为 1 表示 `true`；

项目中的持久层使用的 `mybatis-plus`，一般都使用 `mybais-plus` 逆向生成对应的实体类。



### 手动加密

具体采用 md5 + 随机字符串 实现；

`md5` 是不可逆加密，`md5` 相同的密码每次加密都一样，不太安全。在 `md5` 的基础上手动加盐（salt）处理；



**注册流程：**

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625224441208.png" alt="image-20240625224441208" style="zoom:35%;" />

**登录流程：**

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625224614946.png" alt="image-20240625224614946" style="zoom:35%;" />



**用户访问流程：**

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625224814630.png" alt="image-20240625224814630" style="zoom:35%;" />

- 用户输入了用户名和密码进行登录，校验成功后返回 `jwt`（基于当前用户的id生成）；
- 用户游客登录，生成 `jwt` 返回（基于默认值0生成）；



### 代码实现

TJU-campus-service 依赖信息说明

<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625225912387.png" alt="image-20240625225912387" style="zoom:45%;" />

在 `TJU-campus-service` 下创建工程 `TJU-campus-user`：



<img src="../media/2024-06-25-%E9%A1%B9%E7%9B%AE%E5%9F%BA%E6%9C%AC%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BB%8B%E7%BB%8D/image-20240625230838045.png" alt="image-20240625230838045" style="zoom:45%;" />



















